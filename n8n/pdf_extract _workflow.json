{
  "name": "pdf_extract",
  "nodes": [
    {
      "parameters": {
        "method": "PATCH",
        "url": "=https://api.notion.com/v1/pages/{{ $('get notion page').item.json.results[0].id }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer ntn_xxx"
            },
            {
              "name": "Notion-Version",
              "value": "2022-06-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"properties\": {\n    \"ì œëª©\": {\n      \"title\": [\n        {\n          \"text\": {\n            \"content\": \"{{ $json.output.title }}\"\n          }\n        }\n      ]\n    }\n  }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2208,
        -96
      ],
      "id": "54124a25-be26-4a91-89ba-c228c16f1b12",
      "name": "Update title"
    },
    {
      "parameters": {
        "operation": "pdf",
        "binaryPropertyName": "=data",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1.1,
      "position": [
        -2768,
        -96
      ],
      "id": "5a3d44c3-c9f3-419e-bd0f-b3196c9d82b8",
      "name": "Extract from File"
    },
    {
      "parameters": {
        "jsCode": "const MAX_LENGTH = 2000;\n\nfor (const item of $input.all()) {\n  const content = item.json.output?.content || \"\";\n\n  // 2000ì ë‹¨ìœ„ë¡œ ë¶„ë¦¬\n  const chunks = [];\n  for (let i = 0; i < content.length; i += MAX_LENGTH) {\n    chunks.push(content.slice(i, i + MAX_LENGTH));\n  }\n\n  // ê²°ê³¼ ì¶”ê°€\n  item.json.content_chunks = chunks;\n  item.json.is_split = content.length > MAX_LENGTH;\n}\n\nreturn $input.all();\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2192,
        80
      ],
      "id": "3556a8f4-0b31-40a3-b386-06aee756145d",
      "name": "split chunks"
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n\t\"type\": \"object\",\n\t\"properties\": {\n\t\t\"title\": {\n\t\t\t\"type\": \"string\"\n\t\t},\n\t\t\"content\": {\n\t\t\t\"type\": \"string\"\n\t\t}\n\t}\n}",
        "autoFix": true
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        -2512,
        80
      ],
      "id": "2df4eccd-1bb5-474e-ba04-9c739cc7e59c",
      "name": "Structured Output Parser"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.text }}",
        "hasOutputParser": true,
        "messages": {
          "messageValues": [
            {
              "message": "=ë‹¹ì‹ ì€ ë…¼ë¬¸ì„ ë…ìê°€ ì‰½ê²Œ ì´í•´í•˜ë„ë¡ ì¬êµ¬ì„±í•˜ëŠ” ì „ë¬¸ ì—ë””í„°ì…ë‹ˆë‹¤.\n\nì…ë ¥ìœ¼ë¡œ ì œê³µëœ í…ìŠ¤íŠ¸ëŠ” â€œë…¼ë¬¸ PDFì—ì„œ ì¶”ì¶œëœ ì›ë¬¸â€ì…ë‹ˆë‹¤.\në…¼ë¬¸ì˜ ì œëª©ê³¼ ë³¸ë¬¸ì´ ëª¨ë‘ í¬í•¨ë˜ì–´ ìˆìœ¼ë©°, ì œëª©ì€ ë³¸ë¬¸ ë‚´ìš©ì˜ ì²« ë¬¸ì¥ì…ë‹ˆë‹¤.\nì´ë¥¼ í•œêµ­ì–´ë¡œ ì‰½ê³  ì¹œê·¼í•˜ê²Œ ê°ìƒ‰í•˜ë˜, ë‹¤ìŒ ê·œì¹™ì„ ë°˜ë“œì‹œ ë”°ë¥´ì„¸ìš”.\n\n---\n\n[ìŠ¤íƒ€ì¼ ê°€ì´ë“œ]\n\n0. (ìµœìš°ì„  ê·œì¹™) ìˆ«ì ëª…ì‹œ ë¦¬ìŠ¤íŠ¸ ë³´ì¡´:\n\n   * ê° ë²ˆí˜¸ëŠ” ì›ë¬¸ì—ì„œ ëŒ€ì‘ë˜ëŠ” í•­ëª© 1ê°œë¥¼ 1:1ë¡œ ìœ ì§€í•´ì•¼ í•©ë‹ˆë‹¤.\n   * ë§Œì•½ ì›ë¬¸ì— ìˆ«ìê°€ ëª…ì‹œë˜ì–´ ìˆì§€ë§Œ ì‹¤ì œ í•­ëª© ìˆ˜ê°€ ë¶ˆëª…í™•í•˜ë©´,\n     ë…¼ë¬¸ ë‚´ìš©ì„ ë¶„ì„í•˜ì—¬ ê°€ëŠ¥í•œ Nê°œë¥¼ ë³µì›í•´ ì‘ì„±í•˜ì„¸ìš”.\n\n1. ê¸€ êµ¬ì¡°:\n\n   * ì œëª©ì€ ì›ë¬¸ í…ìŠ¤íŠ¸ì˜ ì²« ë¬¸ì¥(ì²« ì¤„)ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë˜, ìì—°ìŠ¤ëŸ¬ìš´ í•œêµ­ì–´ ì œëª©ìœ¼ë¡œ ì •ë¦¬í•©ë‹ˆë‹¤.\n   * ì œëª©ì˜ ì²˜ìŒê³¼ ëì—ëŠ” ì—°ê´€ëœ ì´ëª¨ì§€ë¥¼ í•˜ë‚˜ì”© ì¶”ê°€í•©ë‹ˆë‹¤.\n\n   ì „ì²´ ê¸€ì€ ë‹¤ìŒ ìˆœì„œë¥¼ ë”°ë¦…ë‹ˆë‹¤:\n   â€¢ ë„ì…: ë¬¸ì œ ì œê¸° ë° ì—°êµ¬ ë°°ê²½(ì™œ ì¤‘ìš”í•œê°€?)\n   â€¢ ë³¸ë¬¸: ë²ˆí˜¸í˜• í•µì‹¬ ìš”ì•½(1ï¸âƒ£, 2ï¸âƒ£, 3ï¸âƒ£ â€¦ ì‚¬ìš©)\n   â€¢ ê²°ë¡ : ğŸ’¡ ë§ˆë¬´ë¦¬í•˜ë©° (í•µì‹¬ ìš”ì•½ + ì‹¤ë¬´/ì—°êµ¬ ê´€ì  í†µì°°)\n\n2. ë¬¸ì²´:\n\n   * ì„¤ëª…í•˜ë“¯ ì¹œê·¼í•œ êµ¬ì–´ì²´ë¡œ ì‘ì„±í•˜ë˜, ê¸°ìˆ  ì „ë¬¸ì„±ì„ ìœ ì§€í•©ë‹ˆë‹¤.\n   * ë¬¸ì¥ì€ ì§§ê³  ëª…í™•í•˜ê²Œ ëŠìŠµë‹ˆë‹¤.\n   * ë§ˆí¬ë‹¤ìš´ ë¬¸ë²•(#, )ì€ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”.\n   * ë¶ˆí•„ìš”í•œ ì˜ì–´ ë‚¨ìš©ì€ í”¼í•˜ê³ , ê¸°ìˆ ìš©ì–´ë§Œ ì˜ì–´ë¡œ í‘œê¸°í•©ë‹ˆë‹¤.\n   * ë…¼ë¬¸ íŠ¹ìœ ì˜ ë”±ë”±í•œ í‘œí˜„ì€ ë” ì‰¬ìš´ ë§ë¡œ í’€ì–´ì£¼ì„¸ìš”.\n\n3. ë‚´ìš©:\n\n   * ë…¼ë¬¸ì˜ í•µì‹¬ êµ¬ì„±ìš”ì†Œê°€ ë¹ ì§€ì§€ ì•Šë„ë¡ ìš”ì•½í•˜ì„¸ìš”.\n     ë°˜ë“œì‹œ í¬í•¨í•  í•­ëª©(ë…¼ë¬¸ì— ì¡´ì¬í•œë‹¤ë©´):\n     âœ” ë¬¸ì œ ì •ì˜ / ì—°êµ¬ ì§ˆë¬¸\n     âœ” ê¸°ì¡´ ë°©ë²•ì˜ í•œê³„\n     âœ” ì œì•ˆ ë°©ë²•(í•µì‹¬ ì•„ì´ë””ì–´)\n     âœ” ì‹¤í—˜/í‰ê°€ ë°©ë²•(ë°ì´í„°ì…‹, ì§€í‘œ ë“±)\n     âœ” ì£¼ìš” ê²°ê³¼(ì •ëŸ‰/ì •ì„± ê²°ê³¼)\n     âœ” í•œê³„ì™€ í–¥í›„ ê³¼ì œ\n   * ì½”ë“œ/ìˆ˜ì‹/í‘œ/ì„¸ë¶€ ì‹¤í—˜ ê°’ì€ ìƒëµí•´ë„ ë˜ì§€ë§Œ,\n     â€œë¬´ì—‡ì„ ì™œ í–ˆê³ , ê²°ê³¼ê°€ ì–´ë• ëŠ”ì§€â€ëŠ” êµ¬ì²´ì ìœ¼ë¡œ ì„¤ëª…í•˜ì„¸ìš”.\n   * ë„ˆë¬´ ì¼ë°˜ì ì´ê±°ë‚˜ ëª¨í˜¸í•œ ë¬¸ì¥ì€ í”¼í•˜ê³ , ê°€ëŠ¥í•œ ê²½ìš° ì‹¤ì œ ì˜ˆì‹œ/ë¹„ìœ ë¥¼ ë„£ì–´ì£¼ì„¸ìš”.\n   * ê¸€ ì „ê°œëŠ” â€˜ë¬¸ì œ â†’ ì›ì¸ â†’ í•´ê²°(ë°©ë²•) â†’ ê²°ê³¼ â†’ ì‹œì‚¬ì â€™ êµ¬ì¡°ë¥¼ ìœ ì§€í•©ë‹ˆë‹¤.\n\n4. í†¤ & ë§ˆë¬´ë¦¬:\n\n   * ê²°ë¡ ë¶€ëŠ” ë‹¨í˜¸í•˜ë©´ì„œë„ ê¸ì •ì ìœ¼ë¡œ ë§ˆë¬´ë¦¬í•©ë‹ˆë‹¤.\n   * ë§ˆì§€ë§‰ ë¬¸ì¥ì€ ë…ìê°€ â€˜í•œ ì¤„ êµí›ˆâ€™ì„ ì–»ì„ ìˆ˜ ìˆë„ë¡ ì •ë¦¬í•©ë‹ˆë‹¤.\n\n5. ê°€ë“œë ˆì¼:\n\n   * ì „ì²´ ê¸€ììˆ˜ëŠ” 2000ì ë‚´ì™¸ë¡œ ì‘ì„±í•˜ì„¸ìš”.\n   * ì¶œë ¥ì€ ìˆœìˆ˜í•œ ë³¸ë¬¸ í˜•íƒœë¡œë§Œ ìƒì„±í•˜ì„¸ìš”.\n   * ë¶ˆí•„ìš”í•œ í•´ì„¤, ì œëª© ì•ˆë‚´, ë§ˆí¬ë‹¤ìš´ ë¬¸ë²•ì€ í¬í•¨í•˜ì§€ ë§ˆì„¸ìš”.\n   * PDF í…ìŠ¤íŠ¸ê°€ ê¹¨ì ¸ ìˆê±°ë‚˜ ë¬¸ì¥ì´ ì´ìƒí•œ ê²½ìš°ì—ë„, ë§¥ë½ì„ ìµœëŒ€í•œ ë³µì›í•´ ìì—°ìŠ¤ëŸ½ê²Œ ì‘ì„±í•˜ì„¸ìš”.\n\n---\n\nì¶œë ¥ì€ ì•„ë˜ JSON í˜•ì‹ìœ¼ë¡œë§Œ ì¶œë ¥í•´ì£¼ì„¸ìš”.\n\n{\"title\": \"í•œêµ­ì–´ ì œëª©\", \"content\": \"ìš”ì•½ ë‚´ìš©\"}"
            }
          ]
        },
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.8,
      "position": [
        -2576,
        -96
      ],
      "id": "c8482b03-7c04-42b1-aa7e-08dc7943d6ad",
      "name": "Summarize_Agent"
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "=https://api.notion.com/v1/blocks/{{ $('get notion page').item.json.results[0].id }}/children",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer ntn_xxx"
            },
            {
              "name": "Notion-Version",
              "value": "2022-06-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"children\": [\n    {\n      \"object\": \"block\",\n      \"type\": \"code\",\n      \"code\": {\n        \"language\": \"plain text\",\n        \"rich_text\": [\n          {\n            \"type\": \"text\",\n            \"text\": {\n              \"content\": \"{{ JSON.stringify($json.content_chunks[0]).replace(/^\\\"|\\\"$/g, '') }}\"\n            }\n          }\n        ]\n      }\n    },\n    {\n      \"object\": \"block\",\n      \"type\": \"code\",\n      \"code\": {\n        \"language\": \"plain text\",\n        \"rich_text\": [\n          {\n            \"type\": \"text\",\n            \"text\": {\n              \"content\": \"{{ JSON.stringify($json.content_chunks[1]).replace(/^\\\"|\\\"$/g, '') }}\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1728,
        224
      ],
      "id": "3f06fa6f-94cc-4d70-a25f-f17d28515f06",
      "name": "Update content2"
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "=https://api.notion.com/v1/blocks/{{ $('get notion page').item.json.results[0].id }}/children",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer ntn_xxx"
            },
            {
              "name": "Notion-Version",
              "value": "2022-06-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"children\": [\n    {\n      \"object\": \"block\",\n      \"type\": \"code\",\n      \"code\": {\n        \"language\": \"plain text\",\n        \"rich_text\": [\n          {\n            \"type\": \"text\",\n            \"text\": {\n              \"content\": \"{{ JSON.stringify($json.content_chunks[0]).replace(/^\\\"|\\\"$/g, '') }}\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1728,
        64
      ],
      "id": "597d796b-c8bb-49b2-b204-8d8c2c024ab9",
      "name": "Update content1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "00ead4aa-49be-4c2f-aea3-a89d28305984",
              "leftValue": "={{ $json.is_split }}",
              "rightValue": "true",
              "operator": {
                "type": "boolean",
                "operation": "false",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -2032,
        80
      ],
      "id": "7f43499e-4f4d-438f-b9c1-100cfc3f821f",
      "name": "If over "
    },
    {
      "parameters": {
        "url": "={{ $json.results[0].properties.file.files[0].file.url }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2928,
        -96
      ],
      "id": "4fc8001a-0739-4852-8e2e-cd1b97770ef4",
      "name": "http_to_binary"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -3232,
        -96
      ],
      "id": "6ae95298-c788-404c-afab-edeea7149904",
      "name": "When clicking â€˜Execute workflowâ€™"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.notion.com/v1/databases/DATABASE_ID/query",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer ntn_xxx"
            },
            {
              "name": "Notion-Version",
              "value": "2022-06-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "{\n  \"sorts\": [\n    {\n      \"timestamp\": \"last_edited_time\",\n      \"direction\": \"descending\"\n    }\n  ],\n  \"page_size\": 1\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -3072,
        -96
      ],
      "id": "c2f565ad-e9f0-47a8-8a90-089fc096a7e1",
      "name": "get notion page"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        -2640,
        80
      ],
      "id": "34151269-72da-4873-b6c0-114a67495227",
      "name": "Google Gemini Chat Model"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        -2512,
        224
      ],
      "id": "de074fdd-1de4-4b5d-933d-9e4982788767",
      "name": "Google Gemini Chat Model1",
      "credentials": {
        "googlePalmApi": {
          "id": "ukLhOrK8a4VpWc4W",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Update title": {
      "main": [
        []
      ]
    },
    "Extract from File": {
      "main": [
        [
          {
            "node": "Summarize_Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "split chunks": {
      "main": [
        [
          {
            "node": "If over ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Summarize_Agent",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Summarize_Agent": {
      "main": [
        [
          {
            "node": "Update title",
            "type": "main",
            "index": 0
          },
          {
            "node": "split chunks",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If over ": {
      "main": [
        [
          {
            "node": "Update content1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Update content2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "http_to_binary": {
      "main": [
        [
          {
            "node": "Extract from File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When clicking â€˜Execute workflowâ€™": {
      "main": [
        [
          {
            "node": "get notion page",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get notion page": {
      "main": [
        [
          {
            "node": "http_to_binary",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Summarize_Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Structured Output Parser",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "versionId": "51e9b9fd-7d31-4696-8244-9149caaea2b0",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "9b574ac706455522698985d51afded13a989cdea69e442db0cae10330d4bbc5c"
  },
  "id": "Tj8JWJ2Z30r4OadP",
  "tags": []
}